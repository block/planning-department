<div class="page-header">
  <div>
    <h1><%= @plan.title %> — v<%= @version.revision %></h1>
    <div class="text-sm text-muted mt-md">
      <%= @version.actor_type %> · <%= time_ago_in_words(@version.created_at) %> ago
      <% if @version.change_summary.present? %>
        · <%= @version.change_summary %>
      <% end %>
    </div>
  </div>
  <div class="page-header__actions">
    <%= link_to "All Versions", plan_versions_path(@plan), class: "btn btn--secondary" %>
    <%= link_to "Current", plan_path(@plan), class: "btn btn--secondary" %>
  </div>
</div>

<% if @diff %>
  <div class="card mb-md">
    <h3>Changes from v<%= @version.revision - 1 %></h3>
    <div class="diff-view">
      <%= @diff.to_s(:html).html_safe %>
    </div>
  </div>
<% end %>

<div class="plan-content card">
  <h3>Full Content</h3>
  <%= render_markdown(@version.content_markdown) %>
</div>
